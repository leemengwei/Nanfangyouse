1、excel数据缺少‘本期投入’和‘本期结存’的各项化验。
2、excel数据中的各种红色问号部分。
3、excel中回收率再明确。
4、excel中熔炼炉车间，既然只有‘原料&中间物料’，具体明确哪个是平衡的两端。
5、具体哪些是输出那些是输入？




1、项目工程：/mfs/home/limengwei/Nanfangyouse/2_metal_balance，src下运行：python build_model.py  --PLOT -V, 默认使用SERVER模式，-V为enable矢量计算。默认2000个POP，100个EPOCH。
完整参数
usage: build_model.py [-h] [-E EPOCH] [-P POP]
                      [--WEIGHT_T_VOLUME WEIGHT_T_VOLUME]
                      [--WEIGHT_CU_PERCENTAGE WEIGHT_CU_PERCENTAGE]
                      [--WEIGHT_AU_PERCENTAGE WEIGHT_AU_PERCENTAGE]
                      [--WEIGHT_AG_PERCENTAGE WEIGHT_AG_PERCENTAGE]
                      [--WEIGHT_BALANCE WEIGHT_BALANCE] [-V] [--PLOT]
                      [--NEED_TO_CORRECT NEED_TO_CORRECT]

2、用法：a）启动服务端；b）网页打开，导入数据，数据在data/2-4假数据；c）点击数据校正；
3、目前问题：a）目前现场给到的数据还是不完整，data/2-4假数据是我按照一些我的理解凑出来的，数据中还有很多的细节问题；b）目前铜、金、银回收率的三个框计算有问题，暂略。c）目前页面上计算后显示的铜T金kg银kg回收率为各自的平衡差距；d）方差、上下限均为我自己按固定规则给定；e)目前针对与熔炼厂，我把所有之前的分类如‘原料、中间物料、回收、产品’的分类改成了‘输入、输出’，具体如何参与计算可在web端选择；f）web端支持一些数据的导入、编辑、对比、导出、类型选择功能，但目前不支持设置方差、上下限（我程序里自己给）。





张弛

配方界面：
1、表格里调整比例那一列前面空一列吧。
3、预设参数里不包含“模型因子alpha、 模型因子beta、 模型因子gamma、 优化算法种群数量 、优化算法迭代次数”，取而代之的是模型参数那一栏要生效:模型因子alpha、 模型因子beta、 模型因子gamma、 优化算法种群数量 、优化算法迭代次数，另外，预设参数还要包含粒煤单位耗氧量默认（1100m3/t）、粒煤量默认1.5（t/h）、铁二氧化硅比默认2,给矿量默认150（t/h）.
4、表格中所有上下箭头按钮 +0.01
5、配料输出还需要包含“一次风量m3/h，S/Cu(%)，冰铜量(吨)，渣量(吨)，石英石(吨)”


衔接页面：
1、函数quick_adjust改成quick_recommend，和配方界面统一，“totalOre”改名“totalConsumedAmount”，和配方界面统一.
2、衔接的两个表格各列的顺序和之前保持一致（比如演算比例列跑前面去了），衔接的两个表格，“必选列”改为“衔接”,配方2的各物料不允许勾选此栏(提示：允许的衔接方向：新->旧，如果需要可以将订单1、2交换位置)，配方1可勾选，但也有条件，即配方2中没有的项目才允许勾选（否则提示：对于新旧订单都有的物料，其衔接在实际料斗加料中自动完成）。该表的库存余量允许修改。
3、配方衔接氧料比要放在下面（目前放在了一个tab中），拿直接能看到的明显的地方
4、命名、数值与配方页面统一：例如Fe应该写成冰铜铁含量，默认值48%、最大物料默认4等。。。。。。
5、给矿量默认150（t/h），粒煤单位耗氧量默认（1100m3/t）、粒煤量默认1.5（t/h）、铁二氧化硅比默认2
6、输出的内容还应包含：“总消耗(吨）（除衔接项），总剩余（吨）（除衔接项）”。
7、最下面（或者侧面）给推荐衔接的结果加一个文本输出的Textlabel
8、推荐完了应该还有调整更新的功能（和第一个界面一样）
9、表格中所有上下箭头按钮 +0.01







Again 07-01:
配料页面：
1、上面大表格里的‘库存余量’列删掉，‘演算比例’调整设置层每次0.01
2、‘预设参数’再加一个氧浓度Oxygen_Concentration（上次我忘了），‘预设参数’输入框里面的‘最大类别数’设置成每次加减1，‘模型参数’所有的都设置成每次加减1。
3、输出的表格里，‘调整比例’每次0.01

衔接页面：
1、关于获取得到的表格：‘库存’列删掉，‘库存剩余’每次加减1，另外将此列改名为：‘盘点库存（根据实际情况修改）’。
1-1、考虑两个表分开（内部数据不变，仅展示），订单2的表的‘衔接’列换成‘排除’（排除就不传给我了）。
1-2、考虑加一个‘手动’开关，打开时订单1的表的‘衔接’列和订单2的表的‘排除’列均自动变为‘选择’，‘推荐’按钮自动变为‘确定’。‘确定’按钮不调用后台算法，直接将勾选‘选择’的列拿下来就行，比例以及其他计算参数都不用管，空着就行。
2、‘预设参数’再加一个氧浓度Oxygen_Concentration（上次忘了），并且此处全部显示为灰色，仅展现，不让做任何更改。
3、氧料比再加一个‘配方*’放到最右边。
4、‘推荐衔接结构’：改成‘结果说明’，另外显示文字的框可否改成自适应的？如果返回的文字较多则看不到，或者把框给大点（一整行）。
5、输出的表格‘调整比例’每次+-001




AG0702:
两个界面的输出的‘演算参数’都不要让调整。另外，所有的不允许调整应该还是能选中复制的，目前视觉上ok，但无法选中了。

衔接页面：
1、上面2个表格盘点库存还是调不了（有时候能用有时候不能用）。1中不用有2了，2有不能衔接还需要警报。
3、输出表格的调整比例点不了（有时候能用有时候不能用？）。
4、排除的并没有排除掉。


AG0703:
衔接页面：
1、表配方1中‘库存余量’-->‘希望继续消耗的库存’；表

qixiaoya----张弛
1、界面分开。
2、录入、校正、对比作为分别的标签页面，导出 校正表格。
3、kg---》g, 补充对应含量项。
4、数据对比仅仅：本期结存，无关去掉！列出原有、校正值、百分比三列。
5、横向直接就用滚动。
6、加上一个‘数据设置’range、var 具体列的页面。‘加载默认设置’--‘修改’--‘排除’--‘保存’，排除的不传给我。


2020-07-20
1、金属平衡页面顶端栏标题改正；
2、金属平衡端口默认7002吧（配料是7001不变）；
3、所有页面 ‘数据录入’，‘数据设置’，‘数据校准’，默认值都保留2位小数（web后台算出的值有是十多位小数的）；
4、排除后没传给我这是对的，但是‘数据录入页面’要联动（以标记显示出来），另外，‘数据对比’的表要显示全，和第一个表的行保持一致，不能因为排除了这个表就缺少行（对比差距是0就行了）；
5、‘数据录入’和‘数据校正’的‘上期结存’都需要各自另外的含量的三列；
6、表的横向滚动条不是浏览器的（这样滚动查看起来很麻烦（戚总说的））；


2020-07-25
生成配方：
1、需要给‘更新quick—update’额外传上边的总表。
配方衔接:
1、需要给‘更新quick—update2’额外传上边的两个小表。
2、配方衔接中的‘配方衔接’的两个表的‘演算比例’应该不能调整，而‘希望继续消耗的库存’和‘配方生产后的理论剩余’应该可以调整。（我记得以前正常，现在坏了）
3、配方衔接当处于‘手选’功能时，如果试图勾选，两个表中相同名称的项目，则需要提示拒绝；
4、金属平衡端口默认7002吧（配料是7001不变）；

MyBUG:
1、第二页调整完之后第一页的不能在调整了，全局变量会出错的，必须重新跑配方GA。(same as below)
2、第二页衔接 如果选择手动模式，则其全局变量需要根据前配方1、2来更新TODO,库存余量也不对。(same as 1,即两个更新按钮都要每次独立的更新库存,通过传下面小表的inventory来更新就可以了)
3、手选内容 重叠项目的情况。





4、衔接从手动切换会自动后，推荐不输出了。





